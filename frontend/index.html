<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Visa Explanation Letter</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
      </header>

      <div class="tabs">
        <button class="tab-btn active" data-tab="booking">Booking</button>
        <button class="tab-btn" data-tab="itinerary">L·ªãch tr√¨nh</button>
        <button class="tab-btn" data-tab="letter">Th∆∞ gi·∫£i tr√¨nh</button>
      </div>

      <!-- NEW: AI Booking Section -->
      <div id="bookingSection" class="section">
        <section class="card">
          <h2>ü§ñ AI T·∫°o Booking (Kh√°ch s·∫°n + M√°y bay)</h2>
          <div class="hint">
            AI t·ª± ƒë·ªçc h·ªì s∆° t·ª´ th∆∞ m·ª•c input ‚Üí tr√≠ch xu·∫•t th√¥ng tin chuy·∫øn ƒëi ‚Üí ch·ªçn kh√°ch s·∫°n & chuy·∫øn bay TH·∫¨T cho m·ªçi qu·ªëc gia.
          </div>
        </section>

        <!-- Step 1: Extract Trip Info -->
        <section class="card">
          <h2>üìã B∆∞·ªõc 1: Tr√≠ch xu·∫•t th√¥ng tin chuy·∫øn ƒëi</h2>
          <div class="row">
            <button id="extractTripBtn">Tr√≠ch xu·∫•t t·ª´ input</button>
          </div>
          <div id="tripInfoPanel" class="summary" style="white-space:pre-wrap; margin-top:8px;">Ch∆∞a tr√≠ch xu·∫•t.</div>
        </section>

        <!-- Step 2: AI Generate Booking -->
        <section class="card">
          <h2>‚úàÔ∏è B∆∞·ªõc 2: AI T·∫°o Booking</h2>
          <div class="row">
            <div>
              <label for="bookingOutputAI">Th∆∞ m·ª•c output</label>
              <input id="bookingOutputAI" type="text" value="output" />
            </div>
            <button id="runAIBookingBtn">ü§ñ AI T·∫°o Booking</button>
          </div>
          <div id="aiBookingStatus" class="step-progress" style="margin-top:8px;">Ch∆∞a ch·∫°y.</div>
        </section>

        <!-- AI Reasoning -->
        <section class="card" id="aiReasoningSection" style="display:none;">
          <details class="collapsible" open>
            <summary>üí° L√Ω do AI ch·ªçn</summary>
            <pre id="aiReasoning" class="summary" style="white-space:pre-wrap;"></pre>
          </details>
        </section>

        <!-- Hotel Results -->
        <section class="card">
          <div class="card-header-row">
            <h2>K·∫øt qu·∫£ Booking Kh√°ch s·∫°n</h2>
            <div class="export-btn-group">
              <button id="exportHotelPdfBtn" class="export-pdf-btn" style="display:none;">üìÑ Xu·∫•t PDF</button>
              <button id="exportAllHotelPdfBtn" class="export-pdf-btn export-all" style="display:none;">üìÑ Xu·∫•t t·∫•t c·∫£ PDF</button>
            </div>
          </div>
          <div id="hotelBookingTabs" class="booking-tabs"></div>
          <iframe id="hotelBookingResult" class="booking-frame" title="Hotel Booking Preview"></iframe>
        </section>

        <!-- Flight Results -->
        <section class="card">
          <div class="card-header-row">
            <h2>K·∫øt qu·∫£ Booking M√°y bay</h2>
            <button id="exportFlightPdfBtn" class="export-pdf-btn" style="display:none;">üìÑ Xu·∫•t PDF</button>
          </div>
          <iframe id="flightBookingResult" class="booking-frame" title="Flight Booking Preview"></iframe>
        </section>

        <!-- Manual Override (collapsible) -->
        <section class="card">
          <details class="collapsible">
            <summary>‚öôÔ∏è Ch·ªânh s·ª≠a th·ªß c√¥ng (t·∫°o booking b·∫±ng database)</summary>
            <div class="row" style="margin-top:12px;">
              <div>
                <label for="guestName">T√™n kh√°ch (theo h·ªô chi·∫øu)</label>
                <input type="text" id="guestName" placeholder="VD: NGUYEN VAN A" value="" />
              </div>
              <div>
                <label for="startDate">Ng√†y kh·ªüi h√†nh</label>
                <input type="date" id="startDate" />
              </div>
            </div>
            <div class="row">
              <div>
                <label for="destination">ƒêi·ªÉm ƒë·∫øn</label>
                <input type="text" id="destination" list="destinationList" placeholder="Nh·∫≠p t√™n n∆∞·ªõc..." value="Australia" />
                <datalist id="destinationList"></datalist>
              </div>
              <div>
                <label for="numDays">S·ªë ng√†y</label>
                <input id="numDays" type="number" value="10" min="1" max="30" />
              </div>
              <div>
                <label for="originAirport">S√¢n bay ƒëi</label>
                <select id="originAirport">
                  <option value="HAN">H√† N·ªôi (HAN)</option>
                  <option value="SGN">TP.HCM (SGN)</option>
                </select>
              </div>
              <div>
                <label for="bookingOutput">Th∆∞ m·ª•c output</label>
                <input id="bookingOutput" type="text" value="output" />
              </div>
              <button id="runBookingBtn">T·∫°o Booking (th·ªß c√¥ng)</button>
            </div>
          </details>
        </section>
      </div>

      <div id="itinerarySection" class="section hidden">
        <section class="card">
          <h2>Th√¥ng tin ƒë·∫ßu v√†o l·ªãch tr√¨nh</h2>
          <pre id="summaryItinerary" class="summary">Ch∆∞a c√≥ d·ªØ li·ªáu.</pre>
          <div class="row" style="margin-top: 10px;">
            <div>
              <label for="itParticipants">Participant(s)</label>
              <textarea id="itParticipants" rows="3" placeholder="I, Nguy·ªÖn Th·ªã B·∫£o Ch√¢u (applicant), travelling with my daughter Nguy·ªÖn Th·ªã B·∫£o T√¢m."></textarea>
            </div>
            <div>
              <label for="itTravelStartDate">Travel period - from</label>
              <input id="itTravelStartDate" type="text" placeholder="01 June 2026" />
            </div>
            <div>
              <label for="itTravelEndDate">Travel period - to</label>
              <input id="itTravelEndDate" type="text" placeholder="12 June 2026" />
            </div>
          </div>
          <div class="row" style="margin-top: 10px;">
            <div>
              <label for="itTravelPurpose">Purpose of travel</label>
              <input id="itTravelPurpose" type="text" placeholder="Tourism (short family holiday)" />
            </div>
            <button id="saveItineraryContextBtn">L∆∞u th√¥ng tin l·ªãch tr√¨nh</button>
          </div>
        </section>

        <section class="card">
          <div class="row">
            <div>
              <label for="flightFile">File v√© m√°y bay</label>
              <select id="flightFile"></select>
            </div>
            <div>
              <label for="hotelFile">File booking kh√°ch s·∫°n</label>
              <select id="hotelFile"></select>
            </div>
            <div>
              <label for="itineraryOutput">File output</label>
              <input id="itineraryOutput" type="text" value="output/itinerary.html" />
            </div>
            <button id="runItineraryBtn">T·∫°o l·ªãch tr√¨nh</button>
          </div>
          <div class="hint">
            L·ªãch tr√¨nh ƒë∆∞·ª£c t·∫°o t·ª´ file v√© m√°y bay + booking kh√°ch s·∫°n + th√¥ng tin b·∫°n ƒë√£ nh·∫≠p ·ªü tr√™n.
          </div>
        </section>

        <section class="card">
          <div class="card-header-row">
            <h2>K·∫øt qu·∫£ l·ªãch tr√¨nh</h2>
            <button id="exportItineraryPdfBtn" class="export-pdf-btn">üìÑ Xu·∫•t PDF</button>
          </div>
          <iframe id="itineraryResult" class="itinerary-frame" title="Itinerary Preview"></iframe>
        </section>
      </div>

      <div id="letterSection" class="section hidden">
        <section class="card">
          <details class="collapsible" open>
            <summary>Th∆∞ m·ª•c input</summary>
            <div class="row">
              <div>
                <label for="inputDir">ƒê∆∞·ªùng d·∫´n</label>
                <input id="inputDir" type="text" value="input" />
              </div>
              <button id="refreshBtn">T·∫£i danh s√°ch file</button>
            </div>

            <div id="fileList" class="file-list empty">
              Ch∆∞a c√≥ d·ªØ li·ªáu. B·∫•m "T·∫£i danh s√°ch file".
            </div>
          </details>
        </section>

        <section class="card">
          <div class="row">
            <div>
              <label for="outputPath">File output</label>
              <input id="outputPath" type="text" value="output/letter.txt" />
            </div>
            <button id="loadStepsBtn">T·∫£i tr·∫°ng th√°i</button>
            <button id="runAllBtn">Ch·∫°y t·∫•t c·∫£</button>
          </div>
          <div class="hint">
            Agent ch·ªâ ch·∫°y khi b·∫°n b·∫•m n√∫t t·ª´ng b∆∞·ªõc.
          </div>
        </section>

        <section class="card">
          <h2>C√°c b∆∞·ªõc x·ª≠ l√Ω</h2>
          <div id="stepsList" class="steps-list">Ch∆∞a t·∫£i tr·∫°ng th√°i.</div>
          <div id="stepProgress" class="step-progress">Ch∆∞a ch·∫°y.</div>
          <div class="row" style="margin-top: 10px;">
            <div>
              <label for="writerContext">Th√¥ng tin b·ªï sung cho b∆∞·ªõc "Vi·∫øt th∆∞"</label>
              <textarea id="writerContext" rows="4" placeholder="Nh·∫≠p th√¥ng tin b·ªï sung b·∫°n mu·ªën AI ∆∞u ti√™n khi vi·∫øt th∆∞ gi·∫£i tr√¨nh..."></textarea>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>T·ªïng h·ª£p th√¥ng tin</h2>
          <pre id="summary" class="summary">Ch∆∞a c√≥ d·ªØ li·ªáu.</pre>
        </section>

        <section class="card">
          <h2>R·ªßi ro (ƒëi·ªÉm c·∫ßn gi·∫£i tr√¨nh)</h2>
          <pre id="riskReport" class="summary">Ch∆∞a c√≥ d·ªØ li·ªáu.</pre>
        </section>

        <section class="card">
          <h2>K·∫øt qu·∫£ th∆∞ gi·∫£i tr√¨nh</h2>
          <pre id="result" class="result">Ch∆∞a ch·∫°y.</pre>
        </section>

      </div>

    </div>

    <script src="app.js"></script>
  </body>
</html>

